const {
  app,
  assert
} = require('egg-mock/bootstrap')

describe('should get token success', () => {
  it('should get token from headers', async () => {
    ctx = app.mockContext({
      headers: {
        'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjE2MDU4NTI1IiwiaWF0IjoxNTQwOTE3NDg1LCJleHAiOjE1NDA5NjA2ODV9.0o7A3KfSVweU3wuqWmhIOXt0R809dsnQYhwbfRuN7yI',
      },
    })
    let token = ctx.helper.getAccessToken(ctx)
    assert(token)
  })

  it('should verify token success', async () => {
    ctx = app.mockContext({
      headers: {
        'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjE2MDU4NTI1IiwiaWF0IjoxNTQwOTE3NDg1LCJleHAiOjE1NDA5NjA2ODV9.0o7A3KfSVweU3wuqWmhIOXt0R809dsnQYhwbfRuN7yI',
      },
    })
    const legal = await ctx.helper.verifyToken(ctx, '16058522')
    assert(legal)
  })
})
